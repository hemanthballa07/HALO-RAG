# Data Directory

This directory contains datasets and data-related files for the HALO-RAG project.

## Dataset Loading

The project includes unified dataset loaders for:
- **SQuAD v2.0**: ~150K examples (includes unanswerable questions)
- **Natural Questions (NQ)**: ~300K examples (complex HTML structure)
- **HotpotQA**: ~113K examples (multi-hop questions)

## Unified Schema

All datasets are normalized to a unified schema:
```python
{
    "id": str,              # Unique example ID
    "question": str,        # Question text (normalized)
    "context": str,         # Context/document text (normalized)
    "answers": List[str]    # List of answers (empty list if unanswerable)
}
```

## Usage

### Load Dataset from Config

```python
from src.data import load_dataset_from_config, prepare_for_experiments
import yaml

# Load config
with open("config/config.yaml", 'r') as f:
    config = yaml.safe_load(f)

# Load dataset
examples = load_dataset_from_config(config, split="train")

# Prepare for experiments
queries, ground_truths, relevant_docs, corpus = prepare_for_experiments(examples)
```

### Load Dataset Directly

```python
from src.data import load_dataset

# Load SQuAD v2
examples = load_dataset("squad_v2", split="train", limit=100)

# Load Natural Questions
examples = load_dataset("natural_questions", split="train", limit=100)

# Load HotpotQA
examples = load_dataset("hotpotqa", split="train", limit=100)
```

## Verification

Run the verification script to check dataset loading:
```bash
python experiments/check_dataset_loading.py
```

This will:
- Load the dataset specified in `config/config.yaml`
- Validate the schema
- Print sample examples
- Report statistics
- Save a preview to `data/sample_preview.json`

## Configuration

Dataset configuration is in `config/config.yaml`:

```yaml
datasets:
  active: "squad_v2"  # or "natural_questions", "hotpotqa"
  sample_limit: null  # Limit for testing (null = no limit)
  splits:
    train: "train"
    validation: "validation"
    test: "test"
```

## Cache Directory

Datasets are cached locally. Set the cache directory in `config/config.yaml`:

```yaml
paths:
  cache_dir: "~/.cache/huggingface/datasets/"
```

## Files

- `sample_preview.json`: Preview of loaded dataset (generated by verification script)
